<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Tabs - Client State</title>
</head>
<body>
  <div id="app"></div>

  <script type="module">
    import ui from "/ui.js";

    ui.app("10.7 Tab Navigation")
      .blurb("Tab-based UI with conditional content. Store-driven tab switching.")

      .section("Dashboard")
        .id("tabs")
        .query({ activeTab: "overview" })
        .customView(({ store }) => {
          // Ensure activeTab defaults to "overview" if not set
          if (!store.activeTab) {
            store.activeTab = "overview";
          }
          const tabs = [
            { id: "overview", label: "Overview", icon: "üìä" },
            { id: "users", label: "Users", icon: "üë•" },
            { id: "settings", label: "Settings", icon: "‚öôÔ∏è" },
            { id: "logs", label: "Activity", icon: "üìã" }
          ];

          const content = {
            overview: `
              <div class="grid grid-cols-3 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg">
                  <div class="text-blue-600 text-2xl font-bold">1,234</div>
                  <div class="text-blue-600 text-sm">Total Users</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                  <div class="text-green-600 text-2xl font-bold">89%</div>
                  <div class="text-green-600 text-sm">Uptime</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                  <div class="text-purple-600 text-2xl font-bold">$12.4k</div>
                  <div class="text-purple-600 text-sm">Revenue</div>
                </div>
              </div>
              <p class="text-slate-600">Welcome to your dashboard. Select a tab to view more details.</p>
            `,
            users: `
              <div class="space-y-3">
                ${['Alice Johnson', 'Bob Smith', 'Carol White', 'Dave Brown'].map((name, i) => `
                  <div class="flex items-center gap-3 p-3 bg-slate-50 rounded">
                    <div class="w-10 h-10 bg-slate-300 rounded-full flex items-center justify-center text-white font-bold">${name[0]}</div>
                    <div>
                      <div class="font-medium">${name}</div>
                      <div class="text-sm text-slate-500">${name.toLowerCase().replace(' ', '.')}@example.com</div>
                    </div>
                    <div class="ml-auto text-sm ${i % 2 === 0 ? 'text-green-600' : 'text-slate-400'}">${i % 2 === 0 ? 'Active' : 'Offline'}</div>
                  </div>
                `).join('')}
              </div>
            `,
            settings: `
              <div class="space-y-4">
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded">
                  <div>
                    <div class="font-medium">Dark Mode</div>
                    <div class="text-sm text-slate-500">Enable dark theme</div>
                  </div>
                  <div class="w-12 h-6 bg-slate-300 rounded-full relative cursor-pointer">
                    <div class="w-5 h-5 bg-white rounded-full absolute top-0.5 left-0.5 shadow"></div>
                  </div>
                </div>
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded">
                  <div>
                    <div class="font-medium">Notifications</div>
                    <div class="text-sm text-slate-500">Email notifications</div>
                  </div>
                  <div class="w-12 h-6 bg-blue-500 rounded-full relative cursor-pointer">
                    <div class="w-5 h-5 bg-white rounded-full absolute top-0.5 right-0.5 shadow"></div>
                  </div>
                </div>
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded">
                  <div>
                    <div class="font-medium">Two-Factor Auth</div>
                    <div class="text-sm text-slate-500">Extra security layer</div>
                  </div>
                  <div class="w-12 h-6 bg-slate-300 rounded-full relative cursor-pointer">
                    <div class="w-5 h-5 bg-white rounded-full absolute top-0.5 left-0.5 shadow"></div>
                  </div>
                </div>
              </div>
            `,
            logs: `
              <div class="space-y-2 font-mono text-sm">
                ${['User login: alice@example.com', 'Settings updated', 'New user registered: dave@example.com', 'Payment processed: $99', 'Report generated', 'API key created'].map((log, i) => `
                  <div class="flex gap-3 p-2 ${i % 2 === 0 ? 'bg-slate-50' : ''} rounded">
                    <span class="text-slate-400">${new Date(Date.now() - i * 3600000).toLocaleTimeString()}</span>
                    <span>${log}</span>
                  </div>
                `).join('')}
              </div>
            `
          };

          return `
            <div class="flex border-b border-slate-200 mb-6">
              ${tabs.map(tab => `
                <button class="tab-btn px-4 py-3 font-medium text-sm flex items-center gap-2 border-b-2 -mb-px transition-colors ${
                  store.activeTab === tab.id
                    ? 'border-slate-900 text-slate-900'
                    : 'border-transparent text-slate-500 hover:text-slate-700'
                }" data-tab="${tab.id}">
                  <span>${tab.icon}</span>
                  <span>${tab.label}</span>
                </button>
              `).join('')}
            </div>
            <div class="tab-content">
              ${content[store.activeTab] || ''}
            </div>
          `;
        })
        .onRender(({ store, element }) => {
          element.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              store.activeTab = btn.dataset.tab;
              window.dispatchEvent(new CustomEvent('ui:refresh:tabs'));
            });
          });
        })
        .end()

      .mount();
  </script>
</body>
</html>
